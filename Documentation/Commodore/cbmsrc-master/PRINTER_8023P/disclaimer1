	.PAG 'DISCLAIMER'
;********************************
;*PTRSRC-PROGRAM USED TO DRIVE
; THE EPSON MODEL-3110 MECHANISM
; CONTAINED IN THE PET FORMATTING
; PRINTER MODEL #2023 AND THE
; PRINTER'S ELECTRONICS.
;
;********************************
;COPYRIGHT (C)1978 BY
; COMMODORE BUSINESS MACHINES(CBM)
; AND
;COMMODORE INTERNATIONAL LIMITED
;********************************
	.SKI 5
;********************************
; THIS SOFTWARE IS FURNISHED
; UNDER A LICENSE FOR USE ONLY
; IN A CBM(TM) MODEL 2022 OR 2023
; DOT MATRIX PRINTER AND MAY BE
; COPIED ONLY WITH THE INCLUSION
; OF THE ABOVE COPYRIGHT NOTICE.
;
; THIS SOFTWARE OF ANY OTHER
; COPIES THEREOF MAY NOT BE
; PROVIDED OR OTHERWISE MADE
; AVAILABLE TO ANY OTHER PERSON
; EXCEPT FOR USE ON SUCH SYSTEM
; AND TO ONE WHO AGREES TO THESE
; LICENSE TERMS.
;
; TITLE TO AND OWNERSHIP OF THE
; SOFTWARE SHALL AT ALL TIMES
; REMAIN IN CBM.
;
; THE INFORMATION IN THIS DOCUMENT
; IS SUBJECT TO CHANGE WITHOUT
; NOTICE AND SHOULD NOT BE
; CONSTRUED AS A COMMITMENT BY
; COMMODORE BUSINESS MACHINES.
;
; CBM ASSUMES NO RESPONSIBILITY
; FOR THE USE OR THE RELIABILITY
; OF ITS SOFTWARE ON MACHINES NOT
; SUPPLIED BY CBM.
;********************************
	.PAG
;********************************
;*WRITTEN BY
; JOHN FEAGANS / 24-JAN-78
;
;*VERSION 05
;
;*REVISION LIST
; J.F.=JOHN FEAGANS
; R.S.=RON STEPHENS
;
;07APR79 FIX 6532 TIMER BUG-J.F.
;16APR79 ADD CHARACTER COOLING TIME-J.F.
;16MAY79 ADD DIAGNOSTIC LIGHT-J.F.
;16MAY79 FIX TRACTOR FEED (MOTOR OFF)-J.F.
;18MAY79 ADD BUSNES/GRAPHICS SA-J.F.
;23OCT79 FIX STACK OVERFLOW THAT
;        SET SA=7.-J.F.
;23OCT79 FIX FORMAT SO THAT A ZERO
;        WILL FORMAT.-J.F.
;23OCT79 FIX ALPHA FORMAT TO BREAK
;        ON CHANGE OF SA.-J.F.
;11FEB80 FIXED ERROR MSG SPELLING-R.S.
;11FEB80 FIXED VERTICAL LINE TURNING
;        INTO A HORIZ. LINE IN BUSINESS
;        CHAR. SET-R.S.
;27FEB80 FIXED SO CURRENT LINE
;        MUST BE THRU PRINTING BEFORE
;        SA'S>2 WILL CONTINUE.-R.S.
;27FEB80 ADDED SA=8 TO REVERT BUSINESS
;        CHAR SET BACK TO GRAPHICS.-R.S.
;28FEB80 ADDED PSEUDO CHECK FOR OUT-OF-
;        RANGE LINES PER PAGE COUNT
;        IN THE SA TO SET THIS.-R.S.
;28FEB80 SHORTENED ERROR MESSAGES
;        TO JUST PRINT ERROR NUMBER
;        SO I CREATED CODE SPACE TO
;        FIX ALL REMAINING KNOWN
;        BUGS.-R.S.
;10MAR80 FIXED CODE SO RESET WOULD
;        !NOT! HOME ON RESET.-R.S.
;10MAR80 CHANGED DIAGNOSTIC LOOP SO
;        THAT LOOP WOULD BE MORE
;        HELPFUL PINPOINTING PROBLEMS.-R.S.
;04APR80 DELETED POWER UP RAM&ROM
;        TEST TO MAKE ROOM.-R.S.
;04APR80 REMOVED OLD DEADMAN STUFF.-R.S.
;08APR80 REWROTE MODULE MAIN TO TAKE LESS
;        SPACE & ADDED SA TO TURN OFF ERROR
;        DIAGNOSTICS.-R.S.
;11APR80 REWROTE FRICTION FEED STATE
;        MACHINE TO INCLUDE DEADMAN.-R.S.
;11APR80 FOUND BUG IN FORMAT, ALPHA FIELD
;        WOULD NOT TERMINATE IF TERMINATOR
;        WAS 1 CHAR AFTER END OF FIELD.-R.S.
;11APR80 REWROTE TRACTOR FEED STATE
;        MACHINE TO INCLUDE DEADMAN.-R.S.
;12APR80 FIXED BUG IN ALL INTERRUPT STATES
;        THAT CAUSED FIRST COLUMN OF DOTS
;        TO NOT GET PRINTED (SHOULD
;        HAVE BIT'D AFTER SETTING EDGE DETECT
;        FLAG, NOT BEFORE.-R.S.
;29APR80 REWROTE IEEE MODULE TO GAIN
;        A LOT OF ROM SPACE TO
;        FIX NEWLY FOUND BUGS IN
;        FORMATTER.-R.S.
;29APR80 MOVED IEEE PRIMARY ADDRESS
;        CALCULATION INTO IEEE MODULE
;        TO GAIN RAM (ELIMINATED
;        DEVNO VARIABLE).-R.S.
;29APR80 DELETED EOIFLG VARIABLE IN
;        RAM TO GAIN RAM.-R.S.
;29APR80 1 TIMER BUG WAS LEFT. I FIXED IT.-R.S.
;29APR80 MADE PROGRAMMABLE CHAR ONLY
;        SIX BYTES LIKE IT SHOULD
;        HAVE BEEN, TO GAIN RAM.-R.S.
;05MAY80 FIXED BUG THAT CAUSED TRACTOR
;        TO LOSE PHASE IF FDINC WAS
;        NOT A MULTIPLE OF 4.
;        CAUSED BY SAD1 BEING WRITTEN
;        WITH A CONSTANT TO TURN
;        THE VARIOUS DEVICES ON AND
;        OFF INSTEAD OF AND'ING, AND
;        OR'ING TO SET VARIOUS BITS.-R.S.
;05MAY80 CHANGED ERROR NUMBERS TO
;        LETTERS TO FACILITATE
;        EASIER REMEMBERING.-R.S.
;05MAY80 ADDED TIMED POWER UP HOME SEED,
;        REPLACED RAM TEST, AND
;        ADDED FLASHING TROUBLE LED.
;        MODS MADE TO INIT, WHICH
;        WAS CRUNCHED.-R.S.
;08MAY80 FIXED CR, CS, &LF MIXUP PROBLEM
;        BY REWRITING ROUTINE TERM.-R.S.
;08MAY80 REWROTE INTERP MODULE TO
;        CORRECT LITERAL BEING PRINTED AT
;        BEGINNING AND END PROBLEM,
;        AND TO BREAK ON SA, AND
;        TO TERMINATE CORRECTLY
;        WITH CR, LF OR CS ACTION.-R.S.
;08MAY80 CHANGED IEEE ROUTINE TO INDICATE
;        CHANGE OF SA W/OVERFLOW.-R.S.
;08MAY80 FIXED MAIN LOOPS SO SA'S
;        3,4,5,6,7,8,9 WOULD
;        BREAK ON CHANGE OF SA.-R.S.
;08MAY80 FIXED MAIN LOOPS SO SA'S
;        0,1,2 WOULD BREAK ON
;        CHANGE OF SA OR LINE TERMINATOR
;        DETECTED.-R.S.
;08MAY80 FIXED ERROR HANDLER TO
;        NOT THROW OUT THE CURRENT
;        CHAR ON THE BUS IF OVERFLOW SET.-R.S.
;08MAY80 ADDED OLDSA RAM VARIABLE FOR
;        ABOVE IEEE FIX.-R.S.
;12MAY80 LEFT JUSTIFIED THE UP-ARROW
;        CHAR.-R.S.
;12MAY80 RESTRUCTURED ALLS SA'S
;        SO THEY JUMP TO MODULE
;        FINISH WHEN A CHANGE OF
;        SA OR TERMINATOR OCCURS.
;12MAY80 REMOVED CRFLG RAM VARIABLE.-R.S.
;12MAY80 MODIFIED Q ROUTINE TO
;        NO LONGER SET CRFLG.-R.S.
;12MAY80 MODIFIED FORMATTER TO
;        ONLY USE 3 STACK BYTES.-R.S.
;16MAY80 FIXED FORMATTER SO $ COULD
;        BE USED BEFORE ANY FIELD.-R.S.
;16MAY80 FIXED ZERO NOT PRINTING IN FORMAT
;        MODE BUG.-R.S.
;16MAY80 REINSERTED POWER-UP RAM AND
;        ROM TEST 'CUZ NOW THERE WAS
;        ROOM TO PUT IT IN.-R.S.
;16MAY80 FIXED Q OVERFLOW BUG.-R.S.
;16MAY80 ADDED RAM VAR 'STEP' TO BE USED
;        INSTEAD OF SFLAG IN THE IRQ ROUTINES.-R.S.
;18MAY80 CHANGED CL TO COUNT UP INSTEAD
;        OF DOWN SO Q BUG ABOVE COULD
;        BE FIXED.-R.S.
;********************************
	.END
